# AGENTS.md

## Project overview
Release Notes Scribe is a GitHub Action that generates draft release notes using the OpenAI Responses API. It compares commits between tags, builds a structured prompt from commit messages and diffs, and creates a draft GitHub Release.

## Key files
- action.yml: Action inputs/outputs and runtime metadata.
- src/index.ts: Action entrypoint (wires inputs, calls OpenAI, creates release).
- src/lib.ts: Git and prompt helpers; kept separate for unit testing.
- dist/index.js: Built bundle (generated by ncc; must be committed).
- .github/workflows/ci.yml: CI for tests/build and dist freshness.
- .github/workflows/release.yml: Self-hosted release notes generation on tag pushes.

## Development
- Install: `npm install`
- Lint: `npm run lint`
- Build bundle: `npm run build` (updates `dist/`)

## Testing
- Run tests: `npm test`
- Tests create a temporary git repo to validate tag discovery, commit ranges, and prompt formatting.

## Release process
- Tag-triggered workflows expect semantic tags (e.g., `v1.2.3`).
- Use `fetch-depth: 0` in workflows so tags are available.
- After code changes: run tests, run build, commit `dist/`, then tag and push.
- `npm run release -- vX.Y.Z` updates `package.json`, rebuilds `dist/`, commits, tags, and pushes. Add `--move-major-tag` to update the moving major tag.

## Notes
- The action uses the OpenAI Responses API via the OpenAI client. Model must support Responses API.
- `release.yml` uses `uses: ./` to run the action from the repo itself; consumers use `btfranklin/release-notes-scribe@vX.Y.Z` or a moving major tag.
- Keep README examples aligned with actual defaults and current tag patterns.
